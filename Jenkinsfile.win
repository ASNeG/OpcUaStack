pipeline {
  agent any
  stages {
    stage('build') {
      steps {
        sh 'vagrant up'
        sh 'vagrant powershell -c ".\\build.bat -t local -B Release -i C:\\ASNeG -vs \"Visual Studio 15 2017 Win64\""'
        sh 'vagrant powershell -c ".\\build.bat -t tst -B Release -s C:\\ASNeG -vs \"Visual Studio 15 2017 Win64\""'
      }
    }
  }

  post {
    always {
      sh 'vagrant halt'
    }
  }
}
